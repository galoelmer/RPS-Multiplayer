$(function () {

    // Stores random ID generated by database
    var myUserId = "";
    var remoteUserId = "";

    // Get database reference to all connected users
    var onlineUsersRef = database.ref("/onlineUsersList");

    // '.info/connected' is a boolean value, true if users are connected and false if they are not.
    var connectedRef = database.ref(".info/connected");

    // When the users' connection state changes...
    connectedRef.on("value", function (snapshot) {

        // If they are connected..
        if (snapshot.val()) {

            // Add user to the user connections list.
            var onlineUser = onlineUsersRef.push({
                score: 0,
                choice: "rock",
                name: "Anonymous"
            });

            // Get random id generated by database
            myUserId = onlineUser.key;

            // Remove user from the connection list when they disconnect.
            onlineUser.onDisconnect().remove();
        }
    });

    // Set a maximum number of players to two. Other user are able to connect, but
    // they are no able to play. Only the first two user connections are allow to play.
    onlineUsersRef.limitToFirst(2).once("value", function (snapshot) {

        // Loop through connected-users-list and compares each other IDs to
        // identified the second connection user
        snapshot.forEach(function (user) {

            // If myUserID is different to user.key(id) then
            // the second player is log
            if (user.key != myUserId) {

                console.log("Other player connected!");

                //Gets second player Id from database
                remoteUserId = user.key;

            }

        });

    });

    $("[data-choice]").on("click", function () {

        console.log($(this).attr("data-choice"));

    });

});